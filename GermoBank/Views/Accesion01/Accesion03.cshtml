@model GermoBank.Models.ModelsPersonalizados.Accesion03Model;
@{
    ViewData["Title"] = "Accesion03";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link rel="stylesheet" href="~/css/accesion01.css" />
<link rel="stylesheet" href="~/css/titulos.css" />

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
    label.error {
        color: red;
        white-space: nowrap;
    }

    label {
        white-space: nowrap;
    }

    .card-body {
        padding: 0px;
    }
</style>

<div style=" margin-top:50px;" >

    <form method="post"
          action="AgregarAccesion_03"
          id="myForm"
         >


        <div class="container">

            <div class="row mt-3">
                <div class="col-md-10">
                    <div class="card border-0">
                        <div class="card-body  align-content-center align-self-center align-items-center">
                            <div class="mt-3">
                                <header  id="titulo_xd">agregar accesión</header>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <h1>Datos de localidad:</h1>

                <div class="col-md-4">
                    <div class="card border-0 ">

                        <div class="input-field">
                            <label for="provincia">Provincias:</label>
                            <select id="provincia"
                                    name="provincia"
                                    class="form-select form-select-sm">
                                <option value="">--Seleccione una provincia--</option>
                                @foreach (var provincia in Model.provincias)
                                {           
                                    <option value="@provincia.IdProvinciaPk">
                                        @provincia.NombreProvincia
                                    </option>
                                }   
                            </select>
                        </div>

                        <div class="input-field">
                            <label for="canton">Cantones:</label>
                            <select id="canton" name="canton" disabled>
                                <option value="">--Seleccione un cantón--</option>
                            </select>
                        </div>


                        <div class="input-field">
                            <label for="codigo_parroquia">Parroquias:</label>
                            <select id="codigo_parroquia" name="codigo_parroquia" disabled>
                                <option value="">--Seleccione una parroquia--</option>
                            </select>
                        </div>

                        <div class="fields">
                            <div class="input-field">
                                <div>
                                    <label for="c_principal">Calle Principal: </label>
                                    <input type="text"
                                           id="c_principal"
                                           name="c_principal"
                                           placeholder="Calle Principal"
                                           required />
                                </div>
                            </div>
                            <div class="input-field">
                                <div>
                                    <label for="c_secundaria">Calle Secundaria: </label>
                                    <input type="text"
                                           id="c_secundaria"
                                           name="c_secundaria"
                                           placeholder="Calle Secundaria"
                                           required />
                                </div>
                            </div>
                            <div class="input-field">
                                <div>
                                    <label for="referencia">Referencia: </label>
                                    <input type="text"
                                           id="referencia"
                                           name="referencia"
                                           placeholder="Referencia"
                                           required />
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0">
                        <div class="fields">
                            <div class="input-field">
                                <div>
                                    <label for="latitud">Latitud: </label>
                                    <input type="number"
                                           step="any"
                                           id="latitud"
                                           name="latitud"
                                           placeholder="Latitud"
                                           required />
                                </div>
                            </div>
                            <div class="input-field">
                                <div>
                                    <label for="altitud">Altitud: </label>
                                    <input type="number"
                                           step="any"
                                           id="altitud"
                                           name="altitud"
                                           placeholder="Altitud"
                                           required />
                                </div>
                            </div>
                            <div class="input-field">
                                <div>
                                    <label for="longitud">Longitud: </label>
                                    <input type="number"
                                           step="any"
                                           id="longitud"
                                           name="longitud"
                                           placeholder="Longitud"
                                           required />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card border-0">
                        <div class="input-field">
                            <label for="codigo_forma_geograficas">Forma geográfica:</label>
                            <select id="codigo_forma_geograficas"
                                    name="codigo_forma_geograficas"
                                    class="form-select form-select-sm">
                                <option value="">
                                    --Seleccione una forma geográfica--
                                </option>
                                @foreach (var forma_geografica in
                                Model.formasGeograficasTbs)
                                {           
                                    <option value="@forma_geografica.IdFormaGeograficaPk">
                                        @forma_geografica.NombreFormaGeografica
                                    </option>
                                }   
                            </select>
                        </div>
                        <div class="input-field">
                            <div>
                                <label for="temperatura">Temperatura: </label>
                                <input type="number"
                                       step="any"
                                       id="temperatura"
                                       name="temperatura"
                                       placeholder="Temperatura"
                                       required />
                            </div>
                        </div>
                        <div class="input-field">
                            <div>
                                <label for="humedad">Humedad: </label>
                                <input type="number"
                                       step="any"
                                       id="humedad"
                                       name="humedad"
                                       placeholder="Humedad"
                                       required />
                            </div>
                        </div>
                        <div class="input-field">
                            <div>
                                <label for="luz">Luz: </label>
                                <input type="text"
                                       id="luz"
                                       name="luz"
                                       placeholder="Luz"
                                       required />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <div class="col-md-12">
                    <div class="card border-0">
                        <div class="card-body  align-content-center align-self-center align-items-center">
                            <div class="mt-3">
                                <input type="submit" value="SIGUIENTE" class="btn btn-outline-success" />

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>






    </form>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>

<script>
    $(function () {
        $("#provincia").change(function () {
            var IdProvinciaPk = $(this).val();
            console.log("Valor seleccionado en #provincia: " + IdProvinciaPk);
            if (IdProvinciaPk) { // verifica si hay un valor seleccionado en el control "familia"
                $("#canton").prop("disabled", false);
                $("#codigo_parroquia").prop("disabled", true);

                $.ajax({
                    url: "@Url.Action("ObtenerCantonesPorProvincia", "Accesion01")",
                    type: 'Post',
                    data: { IdProvinciaPk: IdProvinciaPk },
                    success: function (cantones) {
                        $("#canton").empty().append("<option value=''>--Seleccione un canton--</option>");
                        $.each(cantones, function (i, canton) {
                            $("#canton").append("<option value='" + canton.idCantonPk + "'>" + canton.nombreCanton + "</option>");
                            console.log(canton.IdCantonPk);
                            console.log(canton);
                        });
                        console.log(cantones);
                    }
                });
            }
            else {
                // deshabilita los controles si no se ha seleccionado una opción válida en "familia"
                $("#canton").prop("disabled", true);
                $("#codigo_parroquia").prop("disabled", true);
            }
        });


        $("#canton").change(function () {
            var IdCantonPk = $(this).val();
            if (IdCantonPk) {
                $("#codigo_parroquia").prop("disabled", false);
                $.ajax({
                    url: "@Url.Action("ObtenerParroquiasPorCantone", "Accesion01")",
                    type: "POST",
                    data: { IdCantonPk: IdCantonPk },
                    success: function (parroquias) {
                        $("#codigo_parroquia").empty().append("<option value=''>--Seleccione una parroquia--</option>");
                        $.each(parroquias, function (i, parroquia) {
                            $("#codigo_parroquia").append("<option value='" + parroquia.idParroquiaPk + "'>" + parroquia.nombreParroquia + "</option>");
                        });
                    }
                });
            }
            else {
                $("#codigo_parroquia").prop("disabled", true);
            }
        });

    });
</script>





@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}

<script>
    $(document).ready(function () {
        $('#myForm').validate({
            rules: {
                provincia: {
                    required: true
                },
                canton: {
                    required: true
                },
                codigo_parroquia: {
                    required: true
                },
                c_principal: {
                    required: true
                },
                // Agregar validaciones para los campos de texto, número y fecha
                c_secundaria: {
                    required: true,
                },

                referencia: {
                    required: true,
                },

                latitud: {
                    required: true,
                },

                altitud: {
                    required: true,
                },

                longitud: {
                    required: true,
                },

                codigo_forma_geograficas: {
                    required: true,
                },

                temperatura: {
                    required: true,
                },


                humedad: {
                    required: true,
                },

                luz: {
                    required: true,
                }
            },
            messages: {
                provincia: {
                    required: 'Por favor seleccione una provincia'
                },
                canton: {
                    required:  'Por favor seleccione un cantón'
                },
                codigo_parroquia: {
                    required: 'Por favor seleccione una parroquia'
                },
                c_principal: {
                    required: 'Por favor ingrese una calle principal'
                },
                // Agregar validaciones para los campos de texto, número y fecha
                c_secundaria: {
                    required: 'Por favor ingrese una calle secundaria'
                },

                referencia: {
                    required: 'Por favor ingrese una referencia'
                },

                latitud: {
                    required: 'Por favor ingrese la latitud'
                },

                altitud: {
                    required: 'Por favor ingrese la altitud'
                },

                longitud: {
                    required: 'Por favor la longitud'
                },

                codigo_forma_geograficas: {
                    required: 'Por favor seleccione una forma geográfica'

                temperatura: {
                    required:  'Por favor ingrese el porcentaje de humedad'
                },


                humedad: {
                    required: 'Por favor ingrese el humedad en Celsius'
                },

                luz: {
                    required: 'Por favor ingrese la el tipo de luz'
                }
 
            }
        });
    });

</script>v